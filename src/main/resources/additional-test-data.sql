-- Motify汽车维修管理系统 - 额外测试数据
-- 创建日期: 2025年6月4日
-- 说明: 补充更多测试场景数据

-- 添加更多用户数据
INSERT INTO users (username, password, name, phone, email, address) VALUES
('user009', '$2a$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2uheWG/igi.', '刘老板', '13901234575', 'liulaiban@email.com', '重庆市渝北区两路街道1号'),
('user010', '$2a$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2uheWG/igi.', '陈女士', '13901234576', 'chennvshi@email.com', '天津市和平区南京路1号'),
('user011', '$2a$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2uheWG/igi.', '高先生', '13901234577', 'gaoxiansheng@email.com', '西安市雁塔区高新路1号'),
('user012', '$2a$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2uheWG/igi.', '孙总', '13901234578', 'sunzong@email.com', '青岛市市南区香港中路1号');

-- 添加更多车辆数据（豪华车、新能源车等）
INSERT INTO cars (brand, model, license_plate, user_id) VALUES
-- 刘老板的豪华车队
('保时捷', '911', '渝A88888', 9),
('玛莎拉蒂', '总裁', '渝B77777', 9),
('路虎', '揽胜', '渝C66666', 9),
-- 陈女士的车辆
('特斯拉', 'Model 3', '津A12345', 10),
('小鹏', 'P7', '津B54321', 10),
-- 高先生的车辆
('比亚迪', '汉EV', '陕A99999', 11),
-- 孙总的车辆
('奥迪', 'A8L', '鲁A88888', 12),
('雷克萨斯', 'ES300h', '鲁B77777', 12);

-- 添加更多材料（豪华车专用配件）
INSERT INTO materials (name, description, type, stock, price) VALUES
-- 豪华车专用配件
('保时捷专用机油', '保时捷原厂机油 0W-40', 'LUBRICANT', 50, 280.00),
('玛莎拉蒂刹车片', '玛莎拉蒂原厂Brembo刹车片', 'BRAKE_PARTS', 20, 1200.00),
('路虎空气悬挂', '路虎原厂空气悬挂组件', 'SUSPENSION_PARTS', 10, 3500.00),
-- 新能源车配件
('Tesla充电口', '特斯拉原厂充电接口', 'ELECTRICAL_PARTS', 15, 800.00),
('动力电池组', '磷酸铁锂动力电池包', 'ELECTRICAL_PARTS', 5, 15000.00),
('电机控制器', '新能源车电机控制单元', 'ELECTRICAL_PARTS', 8, 2800.00),
('高压线束', '新能源车高压线束总成', 'ELECTRICAL_PARTS', 30, 450.00),
-- 高端内饰配件
('真皮座椅', '头层牛皮座椅套装', 'OTHER', 20, 2200.00),
('碳纤维饰板', '3K碳纤维内饰面板', 'OTHER', 40, 680.00),
('哈曼卡顿音响', '哈曼卡顿音响系统', 'ELECTRICAL_PARTS', 12, 3200.00);

-- 添加复杂的维修项目
INSERT INTO maintenance_items (name, description, status, progress, result, reminder, score, cost, work_hours, car_id) VALUES
-- 保时捷911维修项目
('发动机大修', '发动机缸体磨损，需要大修', 'IN_PROGRESS', 40, '已拆解发动机，正在加工缸体', '预计还需10个工作日', null, 25000.00, 40.0, 12),
('运动排气改装', '安装保时捷运动排气系统', 'COMPLETED', 100, '改装完成，声浪效果佳', '定期检查排气管固定情况', 5, 8000.00, 6.0, 12),

-- 玛莎拉蒂总裁维修项目
('制动系统升级', '升级为Brembo高性能制动系统', 'COMPLETED', 100, '制动性能显著提升', '高性能刹车片寿命相对较短', 5, 15000.00, 8.0, 13),
('变速箱故障', 'ZF 8速变速箱异响', 'IN_PROGRESS', 70, '已确定问题，正在更换阀体', '配件已到货', null, 12000.00, 16.0, 13),

-- 路虎揽胜维修项目
('空气悬挂故障', '后轮空气悬挂漏气', 'PENDING', 0, null, null, null, 4500.00, 5.0, 14),
('全地形系统检修', '四驱系统故障灯亮', 'PENDING', 0, null, null, null, 8000.00, 12.0, 14),

-- 特斯拉Model 3维修项目
('电池组检测', '续航里程下降，需检测电池组', 'IN_PROGRESS', 80, '发现部分电芯性能下降', '准备更换电池模组', null, 18000.00, 10.0, 15),
('自动驾驶系统标定', 'AP系统摄像头需重新标定', 'COMPLETED', 100, '标定完成，系统正常', '避免强光直射摄像头', 4, 1200.00, 3.0, 15),

-- 小鹏P7维修项目
('OTA升级', '车机系统升级到最新版本', 'COMPLETED', 100, '升级成功，新增多项功能', '定期关注OTA推送', 5, 0.00, 1.0, 16),
('激光雷达清洁', '激光雷达被污染，影响感知', 'COMPLETED', 100, '清洁完成，雷达工作正常', '雨雪天气后及时清洁', 5, 200.00, 0.5, 16),

-- 比亚迪汉EV维修项目
('DiLink系统故障', '车机黑屏，无法启动', 'IN_PROGRESS', 60, '已确定主板故障', '等待更换主板', null, 2800.00, 4.0, 17),

-- 奥迪A8L维修项目
('空气悬挂保养', '四轮空气悬挂例行保养', 'PENDING', 0, null, null, null, 3200.00, 6.0, 18),
('MMI系统升级', '多媒体系统软件升级', 'PENDING', 0, null, null, null, 800.00, 2.0, 18),

-- 雷克萨斯ES300h维修项目
('混动系统检查', '混动系统定期检查保养', 'COMPLETED', 100, '混动系统工作正常', '下次检查：1年后', 5, 1500.00, 4.0, 19);

-- 添加对应的维修记录详情
INSERT INTO record_infos (create_time, update_time, complete_time, total_amount, material_cost, labor_cost, item_id) VALUES
-- 保时捷项目
('2024-05-20 08:00:00', '2024-06-04 17:00:00', null, 25000.00, 15000.00, 10000.00, 12),
('2024-05-10 09:00:00', '2024-05-12 17:00:00', '2024-05-12 17:00:00', 8000.00, 6000.00, 2000.00, 13),

-- 玛莎拉蒂项目
('2024-05-08 10:00:00', '2024-05-10 16:00:00', '2024-05-10 16:00:00', 15000.00, 12000.00, 3000.00, 14),
('2024-05-28 14:00:00', '2024-06-04 15:00:00', null, 12000.00, 8000.00, 4000.00, 15),

-- 路虎项目
('2024-06-04 09:00:00', '2024-06-04 09:00:00', null, 4500.00, 3500.00, 1000.00, 16),
('2024-06-04 10:00:00', '2024-06-04 10:00:00', null, 8000.00, 5000.00, 3000.00, 17),

-- 特斯拉项目
('2024-06-01 11:00:00', '2024-06-04 14:00:00', null, 18000.00, 15000.00, 3000.00, 18),
('2024-05-30 13:00:00', '2024-05-30 16:00:00', '2024-05-30 16:00:00', 1200.00, 200.00, 1000.00, 19),

-- 小鹏项目
('2024-05-25 14:00:00', '2024-05-25 15:00:00', '2024-05-25 15:00:00', 0.00, 0.00, 0.00, 20),
('2024-05-28 16:00:00', '2024-05-28 16:30:00', '2024-05-28 16:30:00', 200.00, 50.00, 150.00, 21),

-- 比亚迪项目
('2024-06-02 10:00:00', '2024-06-04 12:00:00', null, 2800.00, 2000.00, 800.00, 22),

-- 奥迪项目
('2024-06-04 13:00:00', '2024-06-04 13:00:00', null, 3200.00, 2000.00, 1200.00, 23),
('2024-06-04 14:00:00', '2024-06-04 14:00:00', null, 800.00, 200.00, 600.00, 24),

-- 雷克萨斯项目
('2024-05-22 08:30:00', '2024-05-22 12:30:00', '2024-05-22 12:30:00', 1500.00, 800.00, 700.00, 25);

-- 添加高端维修的详细记录
INSERT INTO maintenance_records (name, description, cost, item_id) VALUES
-- 保时捷发动机大修
('缸体加工', '缸体重新镗缸，活塞环更换', 8000.00, 12),
('气门系统检修', '气门、气门座重新研磨', 6000.00, 12),
('曲轴修复', '曲轴抛光，主轴瓦更换', 5000.00, 12),
('正时系统更换', '正时链条及张紧器更换', 3000.00, 12),
('冷却系统检修', '水泵、节温器更换', 2000.00, 12),
('点火系统升级', '高性能点火线圈安装', 1000.00, 12),

-- 保时捷排气系统改装
('排气歧管更换', '安装运动型排气歧管', 3000.00, 13),
('中段排气管', '安装高流量中段', 2500.00, 13),
('尾段排气管', '安装双出尾段', 2000.00, 13),
('排气阀门系统', '安装可变排气阀门', 500.00, 13),

-- 玛莎拉蒂制动系统升级
('Brembo卡钳安装', '前后Brembo 6活塞卡钳', 8000.00, 14),
('刹车盘更换', '通风打孔刹车盘', 4000.00, 14),
('高性能刹车片', 'Brembo陶瓷刹车片', 2000.00, 14),
('刹车油管升级', '钢丝编织刹车油管', 1000.00, 14),

-- 特斯拉电池检测
('电池组拆解', '拆解电池包进行检测', 3000.00, 18),
('电芯测试', '逐个测试电芯性能', 2000.00, 18),
('BMS系统检查', '电池管理系统诊断', 1000.00, 18),
('电池模组更换', '更换性能下降的模组', 12000.00, 18);

-- 添加维修人员分配（复杂项目需要多人协作）
INSERT INTO item_repairman (item_id, repairman_id) VALUES
-- 保时捷发动机大修 - 张师傅(主) + 李技师(辅助)
(12, 1),
(12, 2),
-- 保时捷排气改装 - 陈师傅
(13, 5),
-- 玛莎拉蒂制动升级 - 王师傅
(14, 3),
-- 玛莎拉蒂变速箱 - 李技师
(15, 2),
-- 路虎空气悬挂 - 张师傅
(16, 1),
-- 路虎四驱系统 - 张师傅 + 刘电工
(17, 1),
(17, 4),
-- 特斯拉电池检测 - 刘电工(主) + 赵学徒(辅助)
(18, 4),
(18, 6),
-- 特斯拉AP标定 - 刘电工
(19, 4),
-- 小鹏OTA升级 - 刘电工
(20, 4),
-- 小鹏激光雷达 - 赵学徒
(21, 6),
-- 比亚迪车机故障 - 刘电工
(22, 4),
-- 奥迪空气悬挂 - 张师傅
(23, 1),
-- 奥迪MMI升级 - 刘电工
(24, 4),
-- 雷克萨斯混动检查 - 张师傅 + 刘电工
(25, 1),
(25, 4);

-- 查询一些有趣的统计数据
SELECT '=== 豪华车维修统计 ===' as message;

-- 按车辆品牌统计维修费用
SELECT 
    c.brand as '品牌',
    COUNT(mi.item_id) as '维修次数',
    ROUND(AVG(mi.cost), 2) as '平均费用',
    ROUND(SUM(mi.cost), 2) as '总费用',
    ROUND(MAX(mi.cost), 2) as '最高单次费用'
FROM cars c
LEFT JOIN maintenance_items mi ON c.car_id = mi.car_id
GROUP BY c.brand
HAVING COUNT(mi.item_id) > 0
ORDER BY SUM(mi.cost) DESC;

-- 维修人员工作量统计
SELECT 
    r.name as '维修人员',
    r.specialty as '专长',
    COUNT(ir.item_id) as '参与项目数',
    ROUND(SUM(mi.cost), 2) as '负责项目总值',
    ROUND(SUM(mi.work_hours), 1) as '总工时'
FROM repairmen r
LEFT JOIN item_repairman ir ON r.repairman_id = ir.repairman_id
LEFT JOIN maintenance_items mi ON ir.item_id = mi.item_id
GROUP BY r.repairman_id
ORDER BY SUM(mi.cost) DESC;

-- 用户消费统计
SELECT 
    u.name as '客户姓名',
    COUNT(DISTINCT c.car_id) as '车辆数量',
    COUNT(mi.item_id) as '维修次数',
    ROUND(SUM(mi.cost), 2) as '总消费',
    ROUND(AVG(mi.cost), 2) as '平均单次费用'
FROM users u
LEFT JOIN cars c ON u.user_id = c.user_id
LEFT JOIN maintenance_items mi ON c.car_id = mi.car_id
GROUP BY u.user_id
HAVING COUNT(mi.item_id) > 0
ORDER BY SUM(mi.cost) DESC;
